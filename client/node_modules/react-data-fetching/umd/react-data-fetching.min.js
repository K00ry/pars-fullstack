!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e(t.ReactDataFetching={},t.React)}(this,function(t,e){"use strict";function r(t,e){return t(e={exports:{}},e.exports),e.exports}var o="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function n(){}var i=r(function(t){t.exports=function(){function t(t,e,r,n,i,a){if(a!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var r={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return r.checkPropTypes=n,r.PropTypes=r,r}()}),a=function(t,e,r,o,n,i,a,s){if(!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,o,n,i,a,s],p=0;(c=new Error(e.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},s=(i.oneOf(["DELETE","FORM_DATA","GET","HEAD","PATCH","POST","PUT","TRACE"]),i.shape({getState:i.func})),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function o(n,i){try{var a=e[n](i),s=a.value}catch(t){return void r(t)}if(!a.done)return Promise.resolve(s).then(function(t){o("next",t)},function(t){o("throw",t)});t(s)}("next")})}},p=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},d=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},l=function(){var t=function(t){function r(){var e,o;p(this,r);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o=h(this,t.call.apply(t,[this].concat(i))),o.rdfApi=o.props.api,o.rdfHeaders=o.props.headers,o.rdfInterceptor=o.props.onIntercept,o.rdfLoader=o.props.loader,o.rdfStore=o.context&&o.context.store?o.context.store.getState():o.props.store,o.rdfTimeout=o.props.timeout,o.componentWillReceiveProps=function(){return null},h(o,e)}return d(r,t),r.prototype.componentDidMount=function(){},r.prototype.getChildContext=function(){return{rdfApi:this.rdfApi||"",rdfHeaders:this.rdfHeaders,rdfInterceptor:this.rdfInterceptor,rdfLoader:this.rdfLoader,rdfStore:this.props.store||this.rdfStore,rdfTimeout:this.rdfTimeout}},r.prototype.render=function(){return e.Children.only(this.props.children)},r}(e.Component);return t.defaultProps={api:void 0,headers:{},loader:void 0,onIntercept:void 0,store:void 0,timeout:void 0},t.contextTypes={store:s},t.childContextTypes={rdfApi:i.string,rdfHeaders:i.object,rdfInterceptor:i.func,rdfLoader:i.oneOfType([i.element,i.func]),rdfStore:i.object,rdfTimeout:i.number},t}(),y=r(function(t){!function(e){var r,o=Object.prototype,n=o.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag",u=e.regeneratorRuntime;if(u)t.exports=u;else{(u=e.regeneratorRuntime=t.exports).wrap=_;var p="suspendedStart",f="suspendedYield",d="executing",h="completed",l={},y={};y[a]=function(){return this};var m=Object.getPrototypeOf,v=m&&m(m(A([])));v&&v!==o&&n.call(v,a)&&(y=v);var g=T.prototype=w.prototype=Object.create(y);O.prototype=g.constructor=T,T.constructor=O,T[c]=O.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===O||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,T):(t.__proto__=T,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(g),t},u.awrap=function(t){return{__await:t}},x(L.prototype),L.prototype[s]=function(){return this},u.AsyncIterator=L,u.async=function(t,e,r,o){var n=new L(_(t,e,r,o));return u.isGeneratorFunction(e)?n:n.next().then(function(t){return t.done?t.value:n.next()})},x(g),g[c]="Generator",g[a]=function(){return this},g.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var o=e.pop();if(o in t)return r.value=o,r.done=!1,r}return r.done=!0,r}},u.values=A,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(o,n){return s.type="throw",s.arg=t,e.next=o,n&&(e.method="next",e.arg=r),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var o=r.completion;if("throw"===o.type){var n=o.arg;P(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,o){return this.delegate={iterator:A(t),resultName:e,nextLoc:o},"next"===this.method&&(this.arg=r),l}}}function _(t,e,r,o){var n=e&&e.prototype instanceof w?e:w,i=Object.create(n.prototype),a=new j(o||[]);return i._invoke=function(t,e,r){var o=p;return function(n,i){if(o===d)throw new Error("Generator is already running");if(o===h){if("throw"===n)throw i;return F()}for(r.method=n,r.arg=i;;){var a=r.delegate;if(a){var s=E(a,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var c=b(t,e,r);if("normal"===c.type){if(o=r.done?h:f,c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=h,r.method="throw",r.arg=c.arg)}}}(t,r,a),i}function b(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function w(){}function O(){}function T(){}function x(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function L(t){var e;this._invoke=function(r,o){function i(){return new Promise(function(e,i){!function e(r,o,i,a){var s=b(t[r],t,o);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&n.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):Promise.resolve(u).then(function(t){c.value=t,i(c)},a)}a(s.arg)}(r,o,e,i)})}return e=e?e.then(i,i):i()}}function E(t,e){var o=t.iterator[e.method];if(o===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=b(o,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var i=n.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return i.next=i}}return{next:F}}function F(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())}),m=function(){return this}()||Function("return this")(),v=m.regeneratorRuntime&&Object.getOwnPropertyNames(m).indexOf("regeneratorRuntime")>=0,g=v&&m.regeneratorRuntime;m.regeneratorRuntime=void 0;var _=y;if(v)m.regeneratorRuntime=g;else try{delete m.regeneratorRuntime}catch(t){m.regeneratorRuntime=void 0}var b=_,w=function t(e){var r,o,n=e.body,i=e.headers,a=e.method,s=e.onProgress,c=void 0===s?function(){return null}:s,p=e.onTimeout,d=e.params,h=e.onIntercept,l=e.url,y=e.timeout,m=void 0===y?0:y,v={Accept:"application/json;charset=UTF-8","Content-Type":"FORM_DATA"===a?"multipart/form-data":"application/json"},g=new FormData,_=l,w=null,O=(r=u(b.mark(function t(e,r,o){return b.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o({response:r.response,request:r});case 1:case"end":return t.stop()}},t,void 0)})),function(t,e,o){return r.apply(this,arguments)}),T=function(t,e){t.abort(),p&&p(),e("Your request took more than "+m+"ms to resolve.")},x=(o=u(b.mark(function r(o,n,i){var a,s,c;return b.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(4===o.readyState)if(a=o.status>=200&&o.status<=299){s=void 0;try{o.responseText&&(s=JSON.parse(o.responseText))}catch(t){s=o.responseText}c={data:s,isOK:a,request:o,status:o.status},n(c)}else h&&(w=h({currentParams:e,request:o,status:o.status}))?n(t(f({},w,{onIntercept:void 0}))):O(o,o,i);case 1:case"end":return r.stop()}},r,void 0)})),function(t,e,r){return o.apply(this,arguments)});"FORM_DATA"===a&&Object.entries(n).length>0&&Object.entries(n).map(function(t){return g.append(t[0],t[1])}),d&&Object.keys(d).length>0&&Object.entries(d).map(function(t,e){return _=0===e?_+"?"+t[0]+"="+JSON.stringify(t[1]):_+"&"+t[0]+"="+JSON.stringify(t[1])});return new Promise(function(t,e){try{var r=new XMLHttpRequest;r.upload&&(r.upload.onerror=function(e){return O(e,r,t)},r.upload.onload=function(){return x(r,t,e)},r.upload.onprogress=c,r.upload.ontimeout=function(){return T(r,e)}),r.onerror=function(e){return O(e,r,t)},r.onprogress=c,r.onreadystatechange=function(){return x(r,t,e)},r.ontimeout=function(){return T(r,e)},r.open("FORM_DATA"===a?"POST":a,_),r.timeout=m,function(t){Object.entries(v).map(function(e){return t.setRequestHeader(e[0],String(e[1]))}),i&&Object.keys(i).length>0&&Object.entries(i).map(function(e){return t.setRequestHeader(e[0],String(e[1]))})}(r),r.send("FORM_DATA"===a?g:"DELETE"===a||"GET"===a||"HEAD"===a||"PUT"===a?null:JSON.stringify(f({},n)))}catch(r){O(r,r,e)}})},O=function(t){function r(){var e,o,n,i=this;p(this,r);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return e=o=h(this,t.call.apply(t,[this].concat(d))),o._data=void 0,o._didCallOnLoad=!1,o._isLoaded=!1,o._isUnmounted=!1,o._fetchData=(n=u(b.mark(function t(e,r){var n,a,s,c,u,p,d,h,l,y,m,v,g;return b.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.body,a=e.headers,s=e.method,c=e.onIntercept,u=e.onProgress,p=e.onTimeout,d=e.params,h=e.path,l=e.url,y=e.timeout,m=void 0,v=0,m=h?""+(r.rdfApi||"")+h:l,r.rdfTimeout&&-1===y?v=r.rdfTimeout:!r.rdfTimeout&&y?v=Math.max(0,y):r.rdfTimeout&&y&&(v=-1===y?r.rdfTimeout:y),t.prev=5,t.next=8,w({url:m||"",body:f({},n),headers:f({},r.rdfHeaders,a),method:s,onTimeout:p,onProgress:u,onIntercept:c||r.rdfInterceptor,params:f({},d),timeout:v});case 8:g=t.sent,o._isUnmounted||o._handleData(f({},g,{store:r.rdfStore})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),o._isUnmounted||o._handleData({error:{content:t.t0,message:"Something went wrong during the request",url:m},isOK:!1,store:r.rdfStore});case 15:case"end":return t.stop()}},t,i,[[5,12]])})),function(t,e){return n.apply(this,arguments)}),o._handleData=function(t){o._isUnmounted||(o._isLoaded=!0,o.props.resultOnly?o._data=t.error||t.data:o._data=t,o._returnData(t))},o._printError=function(t){return t.response&&JSON.stringify(t.response).length?"string"==typeof t.response?t.response:"object"===c(t.response)?JSON.stringify(t.response,null,2):t.response+". Sorry <Fetch /> couldn't turned this into a readable string. Check error.content.request to see what happened.":" .Sorry <Fetch /> couldn't turned this into a readable string. Check error.content.request to see what happened."},o._renderLoader=function(){var t=o.context.rdfLoader,e=o.props.loader;return t&&!e?"function"==typeof t?t():t:!t&&e?"function"==typeof e?e():e:t&&e?"function"==typeof e?e():e:null},o._returnData=function(t){var e=o.props,r=e.onError,n=e.onFetch;n&&n(o._data),t.error&&r&&r(o._data),o._isUnmounted||o.forceUpdate()},o._validateProps=function(t,e){var r=e.rdfApi,o=e.rdfStore,n=e.rdfTimeout,i=t.children,s=t.component,c=t.onTimeout,u=t.onFetch,p=t.path,f=(t.refetch,t.render),d=t.timeout,h=t.url;p||h||("production"!==process.env.NODE_ENV?a(!1,"You must provide a `url` or a `path` to <Fetch />"):a(!1)),p&&(p&&r||("production"!==process.env.NODE_ENV?a(!1,"You must implement <FetchProvider> at the root of your app and provide an `api` in order to use `path`"):a(!1))),"store"===p&&(p&&o||("production"!==process.env.NODE_ENV?a(!1,'You must implement <FetchProvider> at the root of your app and provide a `store` in order to use `path="store"`'):a(!1))),c&&("number"==typeof d&&d>=0||"number"==typeof n&&n>=0||("production"!==process.env.NODE_ENV?a(!1,"You must provide a `timeout` number in ms to <Fetch /> or <FetchProvider> in order to use `onTimeout`"):a(!1))),i||s||f||u||("production"!==process.env.NODE_ENV?a(!1,"You must provide at least one of the following to <Fetch />: children, `component`, `onFetch`, `render`"):a(!1))},h(o,e)}return d(r,t),r.prototype.componentWillMount=function(){this._validateProps(this.props,this.context),this.props.onLoad&&!this._didCallOnLoad&&(this._didCallOnLoad=!0,this.props.onLoad())},r.prototype.componentDidMount=function(){"store"===this.props.path?this._handleData({data:this.context.rdfStore,isOK:!0}):this._fetchData(this.props,this.context)},r.prototype.componentWillReceiveProps=function(t,e){var r=this.props,o=r.onLoad,n=r.path,i=r.refetch,a=r.refetchKey;this._validateProps(t,e),o&&!this._didCallOnLoad&&(this._didCallOnLoad=!0,o()),"store"===n?this._handleData({data:this.context.rdfStore,isOK:!0}):t.path===n&&t.refetch===i&&t.refetchKey===a||(this._isLoaded=!1,this._fetchData(t,e))},r.prototype.componentWillUnmount=function(){this._isUnmounted=!0},r.prototype.shouldComponentUpdate=function(t){return this.props.children!==t.children||(this.props.loader!==t.loader||(this.props.onError!==t.onError||(this.props.onFetch!==t.onFetch||(this.props.onLoad!==t.onLoad||(this.props.path!==t.path||(this.props.params!==t.params||(this.props.refetch!==t.refetch||(this.props.refetchKey!==t.refetchKey||(this.props.render!==t.render||(!!this._isLoaded||!!this._data))))))))))},r.prototype.render=function(){var t=this.props,r=t.children,o=t.component,n=t.render;if(!this._isLoaded&&!this._isUnmounted)return this._renderLoader();if(this._isLoaded&&!this._isUnmounted){if(o)return e.createElement(o,this._data);if("function"==typeof n)return n(this._data);if("function"==typeof r)return r(this._data);if(r&&!function(t){return 0===e.Children.count(t)}(r))return e.Children.only(r)}return null},r}(e.Component);O.contextTypes={rdfApi:i.string,rdfHeaders:i.object,rdfInterceptor:i.func,rdfLoader:i.oneOfType([i.element,i.func]),rdfStore:i.object,rdfTimeout:i.number},O.defaultProps={body:{},children:void 0,component:void 0,loader:void 0,method:"GET",onError:void 0,onFetch:void 0,onLoad:void 0,onProgress:void 0,onTimeout:void 0,params:{},path:void 0,refetch:void 0,refetchKey:void 0,render:void 0,resultOnly:!1,url:void 0,timeout:-1};var T=function(){var t=function(t){function r(){var e,o;p(this,r);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=o=h(this,t.call.apply(t,[this].concat(i))),o.rdfApi=o.props.api,o.rdfHeaders=o.props.headers,o.rdfInterceptor=o.props.onIntercept,o.rdfLoader=o.props.loader,o.rdfStore=o.context&&o.context.store?o.context.store.getState():o.props.store,o.rdfTimeout=o.props.timeout,o.componentWillReceiveProps=function(){return null},h(o,e)}return d(r,t),r.prototype.getChildContext=function(){return{rdfApi:this.rdfApi||"",rdfHeaders:this.rdfHeaders,rdfInterceptor:this.rdfInterceptor,rdfLoader:this.rdfLoader,rdfStore:this.props.store||this.rdfStore,rdfTimeout:this.rdfTimeout}},r.prototype.render=function(){return e.Children.only(this.props.children)},r}(e.Component);return t.defaultProps={api:void 0,headers:{},loader:void 0,onIntercept:void 0,store:void 0,timeout:void 0},t.contextTypes={store:s},t.childContextTypes={rdfApi:i.string,rdfHeaders:i.object,rdfInterceptor:i.func,rdfLoader:i.oneOfType([i.element,i.func]),rdfStore:i.object,rdfTimeout:i.number},t}();t.ConnectedFetch=l,t.Fetch=O,t.FetchProvider=T,t.requestToApi=w,Object.defineProperty(t,"__esModule",{value:!0})});
